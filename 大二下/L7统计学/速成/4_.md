
# 1 P4 方差分析 (ANOVA)

- **主讲人**: 倾铃Kfl
- **视频链接**: [统计学期末速成/复习 归纳总结](https://www.bilibili.com/video/BV1qEqQYGEir/)
- **发布时间**: 2024-12-11 20:33:47

## 1.1 一、方差分析的含义与基本思想

- **含义**：方差分析 (ANOVA) 是一种在多个因素中，找出对研究结果具有**显著影响**的那些因素的方法。
- **核心重点**：
    - 尽管叫方差分析，但其研究的重点**并不是方差本身**，而是**数据之间的变异性**。(可能考判断题)
    - 通过分析数据的误差来源，判断不同组的总体均值是否相等。
- **基本思想**：将数据的总误差分解为两个部分：
    1. **纯随机误差**的影响。
    2. 除随机误差外，来自于**因素效应**的影响。
    - **判断依据**：如果后者（因素效应）明显比前者（随机误差）大，则说明因素效应是显著的。

## 1.2 二、单因素方差分析 (One-Way ANOVA)

用于检验**单个因素**的不同水平（组）是否对研究结果产生显著影响。

> **核心案例**：研究不同学习环境（自习室、咖啡厅、宿舍）是否会显著影响学生的考试成绩。
> - 随机抽取学生，分别安排在 `$3` 种环境中复习一周，然后进行统一考试。

---

### 1.2.1 假设检验 (Hypothesis Testing)

- **原假设 $H_0$**：不同学习环境的考试成绩均值**无**显著差异。
    - $$ H_0: \mu_{自习室} = \mu_{咖啡厅} = \mu_{宿舍} $$
    - 含义：学习环境对考试成绩**没有**显著影响。

- **备择假设 $H_1$**：**至少有**一个学习环境的考试成绩均值与其他组不同。
    - 含义：学习环境对考试成绩**存在**显著影响。

- **重要提醒**： 
    - 方差分析是一种**全局检验**，其结果只能判断**“因素整体”**是否有显著影响，不能具体指出是哪一组与其他组不同。
    - **如何解决**：使用 **多重比较 (Multiple Comparisons)** 的方法。（可能考填空题）

### 1.2.2 误差分解 (Decomposition of Error)

- **组间误差 (Between-Group Error)**：
    - 反映**不同组别均值**之间的差异。
    - 代表**因素效应**的影响（系统误差）。
    - **案例**：自习室、咖啡厅、宿舍三组学生的**平均**考试成绩之间的差异。

- **组内误差 (Within-Group Error)**：
    - 反映**同一组内部个体**之间的差异。
    - 代表**随机误差**的影响。
    - **案例**：同样在自习室复习的学生，因个人专注力不同而导致的成绩差异。

- **总误差 (Total Error)**：
    - 所有数据误差的综合表现。
    - $$ 总误差 = 组间误差 + 组内误差 $$

### 1.2.3 核心概念与计算

#### 1.2.3.1 (1) 平方和 (Sum of Squares, SS)

用于量化数据偏离均值的程度（即误差）。

- **组间平方和 (SSA)**：对应组间误差。
- **组内平方和 (SSE)**：对应组内误差。
- **总平方和 (SST)**：对应总误差。
    - $$ SST = SSA + SSE $$

#### 1.2.3.2 (2) 自由度 (Degrees of Freedom, df)

用于将不同误差部分进行标准化，以便公平比较。

- **变量定义**：
    - $N$：全体观测值的总个数（总学生数）
    - $K$：因素的水平个数（环境种类数）

- **组间自由度 ($df_A$)**:
    - $$ K-1 $$
    - **理解**：在我们案例中，$K=3$。当 `$2` 个组（如自习室、咖啡厅）的均值确定后，第 `$3` 个组（宿舍）的均值为了满足总体均值也就被固定了，所以只有 `$2$` 个可以自由变化。

- **组内自由度 ($df_E$)**:
    - $$ N-K $$
    - **理解**：假设共 `$30` 名学生，分 `$3` 组，每组 `$10` 人。在每组中，前 `$9` 名学生的成绩可以自由变化，但第 `$10` 名学生的成绩会受到该组均值的约束。因此，每组的自由度是 `$10-1=9$`，总的组内自由度是 `$3 \times 9 = 27$`，即 `$30-3=27$`。

- **总自由度 ($df_T$)**:
    - $$ N-1 $$
    - **理解**：在 `$30` 个学生中，当总平均分确定后，前 `$29` 个学生的分数可以自由变化，但第 `$30` 个学生的分数是固定的。

#### 1.2.3.3 (3) 均方 (Mean Square, MS)

将平方和除以对应的自由度，是对误差的标准化度量。

- **组间均方 (MSA)**：
    - $$ MSA = \frac{SSA}{df_A} = \frac{SSA}{K-1} $$

- **组内均方 (MSE)**：
    - $$ MSE = \frac{SSE}{df_E} = \frac{SSE}{N-K} $$

#### 1.2.3.4 (4) F值 (F-Value)

检验统计量，用于衡量组间差异相对于组内差异的显著性。

- **计算公式**:
    - $$ F = \frac{MSA}{MSE} $$
    - 本质是两个方差（均方）的比值，与《两个正态总体方差之比的检验》中的 $F$ 统计量思想一致。

- **F检验的本质**:
    > **所有的F检验本质上都是右侧检验**。
    > **原因**：F值是方差的比值，恒为正数。F值越大，说明组间差异（分子）相对于组内随机差异（分母）越显著。因此，我们只关心F值是否“足够大”，只需设定右侧的拒绝域。

- **决策规则**:
    - **临界值法**：当计算的 F 值 > 临界值 $F_α$，落入拒绝域，**拒绝 $H_0$**，说明因素有显著影响。
    - **P值法**：当 P 值 < 显著性水平 $α$，**拒绝 $H_0$**，说明因素有显著影响。
    - 如果 $F$ 值接近 `$1$`，说明组间和组内差异相近，因素效应不显著。

### 1.2.4 单因素方差分析汇总表

| 差异来源         | 平方和 (SS) | 自由度 (df) | 均方 (MS)                 | F 值                   |
| :----------- | :------- | :------- | :---------------------- | :-------------------- |
| **组间 (因素A)** | $SSA$    | $K-1$    | $MSA = \frac{SSA}{K-1}$ | $F = \frac{MSA}{MSE}$ |
| **组内 (误差E)** | $SSE$    | $N-K$    | $MSE = \frac{SSE}{N-K}$ |                       |
| **总计 (T)**   | $SST$    | $N-1$    |                         |                       |

**关系**: $SST = SSA + SSE$; $(N-1) = (K-1) + (N-K)$

---

## 1.3 三、双因素方差分析 (Two-Way ANOVA)

用于研究**两个因素**及其**交互作用**对实验结果的综合影响。

> **核心案例扩展**：在研究学习环境（因素A）的基础上，增加**学习时长**（因素B，如 `$1` 小时, `$2` 小时, `$3` 小时）这一因素，共同研究它们对考试成绩的影响。

### 1.3.1 回答的三个核心问题

1.  **主效应A**：学习环境是否显著影响考试成绩？
2.  **主效应B**：学习时长是否显著影响考试成绩？
3.  **交互作用**：学习环境和学习时长之间是否存在交互作用？

### 1.3.2 交互作用 (Interaction Effect)

- **定义**：一个因素的影响，是否会因为另一个因素的水平不同而发生显著变化。如果交互作用显著，说明两因素的影响不是简单的“1+1”相加，而是互相影响产生了额外效果。

- **案例理解**:
    - **有交互作用**：在**自习室**，学习时间越长，成绩提升越显著；但在**咖啡厅**和**宿舍**，学习时间长短对成绩影响很小。—— *学习时长的效果，依赖于学习环境的不同水平*。
    - **无交互作用**：无论在**自习室、咖啡厅还是宿舍**，学习时间每增加 `$1` 小时，成绩都平均提高 `$5` 分。—— *两个因素的影响相互独立*。

### 1.3.3 双因素方差分析汇总表

- **变量定义**:
    - $A$: 因素A的水平数 (如环境种类 `$3` 种)
    - $B$: 因素B的水平数 (如时长种类 `$3` 种)
    - $T$: 重复实验的次数

| 差异来源 | 平方和 (SS) | 自由度 (df) | 均方 (MS) | F 值 |
| :--- | :--- | :--- | :--- | :--- |
| **因素 A** | $SSA$ | $A-1$ | $MSA = \frac{SSA}{A-1}$ | $F_A = \frac{MSA}{MSE}$ |
| **因素 B** | $SSB$ | $B-1$ | $MSB = \frac{SSB}{B-1}$ | $F_B = \frac{MSB}{MSE}$ |
| **交互作用 AB** | $SSAB$ | $(A-1)(B-1)$ | $MSAB = \frac{SSAB}{(A-1)(B-1)}$ | $F_{AB} = \frac{MSAB}{MSE}$ |
| **误差 E** | $SSE$ | $AB(T-1)$ | $MSE = \frac{SSE}{AB(T-1)}$ | |
| **总计 T** | $SST$ | $ABT-1$ | | |

**注意**：在双因素方差分析中，所有F值的计算都以 **MSE** 作为分母。

---

## 1.4 四、本章涉及问题汇总

| 问题类型           | 核心知识点           | 解决思路                                                                                                     |
| :------------- | :-------------- | :------------------------------------------------------------------------------------------------------- |
| **判断题**        | 方差分析的研究重点       | 记住研究重点是**数据的变异性**，而非方差本身。                                                                                |
| **填空题**        | 如何解决方差分析的全局性问题  | 填入 **“多重比较”**。                                                                                           |
| **单因素表格填空/计算** | 单因素ANOVA表内各数值关系 | 熟记表格公式：$df_A = K-1$, $df_E = N-K$, $SST=SSA+SSE$, $MSA = SSA/df_A$, $MSE = SSE/df_E$, $F = MSA/MSE$。     |
| **双因素表格填空/计算** | 双因素ANOVA表内各数值关系 | 熟记表格公式：$df_A=A-1$, $df_B=B-1$, $df_{AB}=(A-1)(B-1)$, $df_E=AB(T-1)$, 及对应的MS和F值计算。                        |
| **假设检验决策**     | P值法或临界值法        | - 比较计算出的 $F$ 值与给定的临界值 $F_α$。<br>- 比较给定的 $P$ 值与显著性水平 $α$。<br>- $F > F_α$ 或 $P < α$ → **拒绝 $H_0$** (差异显著)。 |


首先，最重要的一点，我们先纠正一下：
- **SSA** 是 **组间 (Between)** 平方和。
- **SSE** 是 **组内 (Within)** 平方和。
### 1.4.1 快速记忆法 (Mnemonics)

#### 1.4.1.1 方法一：英文首字母联想法 (最推荐)

这个方法最直接，最不容易出错。

- **SSA**: "A" 代表 **Among** (在...之间)。
  - **记忆链条**: **A** -> **A**mong groups (在**各组之间**) -> **组间**
  - 你可以想象，方差分析的目的就是比较**各组之间(Among groups)**的差异，这个差异是由我们施加的因素A (Factor **A**) 引起的。

- **SSE**: "E" 代表 **Error** (误差)。
  - **记忆链条**: **E** -> **E**rror (误差) -> 随机误差存在于**组内部** -> **组内**
  - 什么是误差？即使在**同一个组内**（比如都在自习室学习），每个人的成绩还是不一样，这种无法被因素解释的、随机的波动就是**误差(Error)**，它天然存在于**组内**。

### 1.4.2 MSA 和 MSE 的记忆

一旦你记住了 SSA 和 SSE，MSA 和 MSE 就非常简单了。

**"M"** 代表 **Mean** (均值/平均)。

所以，**均方(MS)** 就是 **平方和(SS)** 的**平均值**。怎么平均？除以它对应的自由度就行了。

- **MSA (组间均方)**:
  - **M**ean **S**quare **A**mong groups.
  - 就是把**组间**平方和 (SSA) 平均一下。
  - $$ MSA = \frac{SSA}{df_A} $$

- **MSE (组内均方)**:
  - **M**ean **S**quare for **E**rror.
  - 就是把**组内**误差平方和 (SSE) 平均一下。
  - $$ MSE = \frac{SSE}{df_E} $$

**总结：** "M" 就是在 "SS" 的基础上增加了一个“求平均”的动作。你只要分清了 "A" 和 "E"，"M" 就不会出错。

### 1.4.3 总结表格

为了方便你快速回顾，这里有一张总结表：

| 缩写 | 英文关键词 | 中文名称 | 记忆线索 |
| :--- | :--- | :--- | :--- |
| **SSA** | **A** = **A**mong (之间) | **组间**平方和 | 我们研究的因素**A**导致了**组与组之间**的差异。 |
| **SSE** | **E** = **E**rror (误差) | **组内**平方和 | 随机**误差E**存在于每一个**组的内部**。 |
| **MSA** | **M** = Mean (均值) | **组间**均方 | 对**组间**平方和SSA求**平均**。 |
| **MSE** | **M** = Mean (均值) | **组内**均方 | 对**组内**平方和SSE求**平均**。 |

记住这个口诀：**A是组间，E是组内 (A for Among, E for Error)**，就不会再混淆了！
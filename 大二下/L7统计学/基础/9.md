

# 1 **第七章 7.3 & 7.4 双总体参数的区间估计与样本量确定**

## 1.1 **1. 两个总体均值之差 (μ₁ - μ₂) 的区间估计**

> [!NOTE] 核心思路
> 均值之差 `μ₁ - μ₂` 最合理的点估计量是样本均值之差 `X̄₁ - X̄₂`。我们的目标是围绕这个点估计，构造一个 `点估计 ± 估计误差` 形式的区间。

---

### 1.1.1 **1.1 小样本，方差已知 (σ₁², σ₂² 已知)**

*   **前提条件**:
    1.  两个总体均为正态总体：
        *   `X₁` 来自 `N(μ₁, σ₁²)` 总体，样本均值 `X̄₁ ~ N(μ₁, σ₁²/n₁)`
        *   `X₂` 来自 `N(μ₂, σ₂²)` 总体，样本均值 `X̄₂ ~ N(μ₂, σ₂²/n₂)`
    2.  两个样本相互独立。

*   **构造统计量**:
    1.  样本均值之差的分布：
        $$
        \bar{X}_1 - \bar{X}_2 \sim N(\mu_1 - \mu_2, \frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2})
        $$
    2.  进行标准化，得到服从标准正态分布的 Z 统计量：
        $$
        Z = \frac{(\bar{X}_1 - \bar{X}_2) - (\mu_1 - \mu_2)}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}} \sim N(0, 1)
        $$

*   **推导逻辑**:
    *   利用标准正态分布的分位数 `Zα/₂`。我们希望构造一个区间，使得统计量 Z 落入 `[-Zα/₂, Zα/₂]` 的概率为 `1-α`。
    *   `P(-Z_{α/2} ≤ Z ≤ Z_{α/2}) = 1-α`
    *   将 Z 的表达式代入并化简，即可得到 `μ₁ - μ₂` 的置信区间。

*   **置信区间公式**:
    > `μ₁ - μ₂` 的 `(1-α)` 置信区间为：
    > $$
    > (\bar{X}_1 - \bar{X}_2) \pm Z_{\alpha/2} \sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}
    > $$

---

### 1.1.2 **1.2 小样本，方差未知但相等 (σ₁² = σ₂²)**

*   **前提条件**:
    *   同 1.1，但总体方差未知，不过假定它们相等。

*   **构造统计量**:
    *   根据第六章 T 分布的结论，通过替换变量（`X₁` 代替 `X`，`X₂` 代替 `Y`，`n₁/n₂` 代替 `m/n`），推导过程完全一致。
    *   我们构造 T 统计量：
        $$
        T = \frac{(\bar{X}_1 - \bar{X}_2) - (\mu_1 - \mu_2)}{S_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}} \sim t(n_1 + n_2 - 2)
        $$
    *   其中，`S_p²` 是 **合并样本方差 (Pooled Sample Variance)**：
        $$
        S_p^2 = \frac{(n_1-1)S_1^2 + (n_2-1)S_2^2}{n_1 + n_2 - 2}
        $$

*   **置信区间公式**:
    > `μ₁ - μ₂` 的 `(1-α)` 置信区间为：
    > $$
    > (\bar{X}_1 - \bar{X}_2) \pm t_{\alpha/2}(n_1+n_2-2) \cdot S_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}
    > $$

> [!TIP] 拓展：方差为已知倍数关系 (σ₂² = Cσ₁²)，C为已知常数
> (此部分为选学内容，适合学有余力的同学，对数学推导要求较高)
> 1.  **构造正态分布**:
>     `X̄₁ - X̄₂ ~ N(μ₁ - μ₂, (1/n₁ + C/n₂)σ₁²)`
> 2.  **构造卡方分布**:
>     ` ( (n₁-1)S₁² / σ₁² ) + ( (n₂-1)S₂² / σ₂² ) = (1/σ₁²) * [ (n₁-1)S₁² + (n₂-1)S₂²/C ] ~ χ²(n₁+n₂-2) `
> 3.  **构造 T 分布**:
>     `T = (标准正态) / √(卡方/自由度)`。将上面两项代入并化简，最终会得到一个修正后的 T 统计量。
> 4.  **最终形式**: 区间形式与 1.2 类似，但 `S_p` 和根号项会根据常数 C 进行修正。可以作为练习自行推导。

---

### 1.1.3 **1.3 小样本，方差未知且不相等 (一般情形)**

*   **前提条件**:
    *   这是最一般、信息最少的情况。

*   **构造统计量**:
    *   此时无法精确构造 T 统计量，使用近似的 T 分布。
        $$
        \text{近似 } T = \frac{(\bar{X}_1 - \bar{X}_2) - (\mu_1 - \mu_2)}{\sqrt{\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2}}} \sim t(v)
        $$
    *   自由度 `v` 的计算公式非常复杂，**需要背诵**。
        > [!DANGER] 自由度 v (最恶心的计算公式)
        > $$
        > v = \frac{(\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2})^2}{\frac{(S_1^2/n_1)^2}{n_1-1} + \frac{(S_2^2/n_2)^2}{n_2-1}}
        > $$
        > **注意**: 计算结果 `v` 一般不为整数，**取最接近的整数**代替。

*   **置信区间公式**:
    > `μ₁ - μ₂` 的 `(1-α)` 置信区间为：
    > $$
    > (\bar{X}_1 - \bar{X}_2) \pm t_{\alpha/2}(v) \sqrt{\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2}}
    > $$

---

### 1.1.4 **1.4 大样本 (n₁, n₂ 较大)**

*   **前提条件**:
    *   **总体可不为正态分布**。因为根据中心极限定理，只要样本量足够大，样本均值 `X̄` 近似服从正态分布。
    *   **若方差未知**，直接用样本方差 `S₁²`, `S₂²` 替代总体方差 `σ₁²`, `σ₂²`。

*   **逻辑**:
    *   此情况下的公式与 **1.3 (方差未知且不相等)** 的形式非常相似。
    *   也与 **1.1 (方差已知)** 的情况类似，只是用 `S²` 替代了未知的 `σ²`。

*   **置信区间公式**:
    > `μ₁ - μ₂` 的 `(1-α)` 置信区间为：
    > $$
    > (\bar{X}_1 - \bar{X}_2) \pm Z_{\alpha/2} \sqrt{\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2}}
    > $$
    > **对比**: 和 1.3 的公式几乎一样，只是把 `t` 分布的分位数换成了 `Z` 分布的分位数。

---

## 1.2 **2. 匹配样本 (Matched / Paired Samples)**

*   **定义**: 两个样本中的元素并非相互独立，而是一一对应的。这种设计可以**消除样本固有的不公平性**对实验结果造成的差异。
*   **例子 (减肥药)**:
    *   **错误设计 (独立样本)**: 找60个胖子服用前测体重，再找另外60个瘦子服用后测体重。这无法说明药效，因为样本本身就有差异。
    *   **正确设计 (匹配样本)**: 找60个人，分别测量他们服用减肥药**前**和服用减肥药**后**的体重。`(X₁, Y₁), (X₂, Y₂), ..., (X₆₀, Y₆₀)`。这里的 `Xᵢ` 和 `Yᵢ` 是匹配的。

*   **核心处理方法**:
    1.  计算每对样本的**差值** `dᵢ = Yᵢ - Xᵢ`。
    2.  将两个匹配样本的问题，**转化为关于差值 `d` 的单总体问题**。
    3.  之后的所有步骤都与单总体的区间估计完全相同。

*   **置信区间公式 (套用单总体)**:
    *   **方差 `σ_d²` 已知 (正态总体)**:
        $$
        \bar{d} \pm Z_{\alpha/2} \frac{\sigma_d}{\sqrt{n}}
        $$
    *   **方差 `σ_d²` 未知 (正态总体)**:
        $$
        \bar{d} \pm t_{\alpha/2}(n-1) \frac{S_d}{\sqrt{n}}
        $$
    *   **大样本 (非正态总体)**: 同理，用 `Z` 分布和 `S_d`。

---

## 1.3 **3. 两个总体比例之差 (π₁ - π₂) 的区间估计**

*   **前提条件**: 大样本。

*   **构造统计量**:
    1.  由单总体比例的结论可知：`P₁ ≈ N(π₁, π₁(1-π₁)/n₁)`，`P₂ ≈ N(π₂, π₂(1-π₂)/n₂)`。
    2.  两者独立，则其差值也近似服从正态分布：
        `P₁ - P₂ ≈ N(π₁-π₂, π₁(1-π₁)/n₁ + π₂(1-π₂)/n₂)`
    3.  标准化后，分母中包含未知的 `π₁` 和 `π₂`。在构造置信区间时，我们无法使用它们。
    4.  **解决方案**: 用样本比例 `P₁` 和 `P₂` 分别替代 `π₁` 和 `π₂`。

*   **置信区间公式**:
    > `π₁ - π₂` 的 `(1-α)` 置信区间为：
    > $$
    > (P_1 - P_2) \pm Z_{\alpha/2} \sqrt{\frac{P_1(1-P_1)}{n_1} + \frac{P_2(1-P_2)}{n_2}}
    > $$

---

## 1.4 **4. 两个总体方差比 (σ₁²/σ₂²) 的区间估计**

*   **前提条件**: 两个独立的样本均来自正态总体。

*   **构造统计量**:
    *   利用第六章关于 F 分布的结论。
    1.  ` (n₁-1)S₁²/σ₁² ~ χ²(n₁-1) `
    2.  ` (n₂-1)S₂²/σ₂² ~ χ²(n₂-1) `
    3.  两个独立的卡方变量除以各自的自由度，其比值服从 F 分布：
        $$
        F = \frac{S_1^2/\sigma_1^2}{S_2^2/\sigma_2^2} = \frac{S_1^2}{S_2^2} \cdot \frac{\sigma_2^2}{\sigma_1^2} \sim F(n_1-1, n_2-1)
        $$

*   **推导逻辑**:
    *   利用 F 分布的两个分位数 `F(1-α/₂)` 和 `F(α/₂)` 来夹住 F 统计量。
    *   ` P(F_{1-\alpha/2} \le \frac{S_1^2}{S_2^2} \cdot \frac{\sigma_2^2}{\sigma_1^2} \le F_{\alpha/2}) = 1-\alpha `
    *   对不等式进行变形，整理出 `σ₁²/σ₂²`。

*   **置信区间公式**:
    > `σ₁²/σ₂²` 的 `(1-α)` 置信区间为：
    > $$
    > \left[ \frac{S_1^2}{S_2^2} \cdot \frac{1}{F_{\alpha/2}(n_1-1, n_2-1)}, \quad \frac{S_1^2}{S_2^2} \cdot \frac{1}{F_{1-\alpha/2}(n_1-1, n_2-1)} \right]
    > $$

---

## 1.5 **5. 样本量的确定 (7.4)**

### 1.5.1 **5.1 估计总体均值 μ**

*   **逻辑**: 置信区间的半径即为我们允许的**估计误差 E**。
    *   `E = Zα/₂ * (σ/√n)`
*   **样本量公式**:
    $$
    n = \frac{Z_{\alpha/2}^2 \sigma^2}{E^2}
    $$

### 1.5.2 **5.2 估计总体比例 π**

*   **逻辑**: 类似地，`E = Zα/₂ * √(π(1-π)/n)`
*   **样本量公式**:
    $$
    n = \frac{Z_{\alpha/2}^2 \pi(1-\pi)}{E^2}
    $$
*   **如何处理未知的 `π`**?
    1.  **利用历史数据或类似研究**：用一个已有的、可靠的比例值作为参考。
    2.  **进行试验性调查 (Pilot Study)**：用小样本得出的 `p` 来估计 `π`。
    3.  **没有任何信息 (最保守估计)**：令 `π(1-π) = 0.25`，即假设 `π=0.5`。
        *   **原因**: `π(1-π)` 是一个关于 `π` 的二次函数，在 `π=0.5` 时取到最大值。使用最大值计算出的 `n` 将是最大的，能够满足所有可能的 `π` 值的情况，因此最保守、最稳妥。

### 1.5.3 **5.3 圆整法则 (Rounding Up Rule)**

*   **官方名称**: 圆整法则。
*   **核心原则**: **向上取整**。
*   **解释**: 样本量 `n` 必须是大于等于计算结果的整数。
    *   例如，计算出 `n = 24.32`，必须取 `n=25`。因为 `n=24` 不足以满足精度要求。
    *   即使计算出 `n = 24.01`，也必须取 `n=25`。**绝不能四舍五入**。

---

## 1.6 **总结表格：双总体参数区间估计**

| 估计参数                | 前提条件                     | (1-α) 置信区间公式                                                                                                                                           |
| :------------------ | :----------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------- |
| **μ₁ - μ₂**         | 小样本，正态总体，**σ₁², σ₂² 已知** | $$(\bar{X}_1 - \bar{X}_2) \pm Z_{\alpha/2} \sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}$`                                                    |
| **μ₁ - μ₂**         | 小样本，正态总体，**σ² 未知但相等**    | $$(\bar{X}_1 - \bar{X}_2) \pm t_{\alpha/2}(n_1+n_2-2) \cdot S_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}$` <br> `S_p² = ((n₁-1)S₁² + (n₂-1)S₂²)/(n₁+n₂-2)` |
| **μ₁ - μ₂**         | 小样本，正态总体，**σ² 未知且不等**    | $$(\bar{X}_1 - \bar{X}_2) \pm t_{\alpha/2}(v) \sqrt{\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2}}$` <br> `v` 按复杂公式计算后取整                                       |
| **μ₁ - μ₂**         | **大样本** (总体可非正态，σ² 未知)   | $$(\bar{X}_1 - \bar{X}_2) \pm Z_{\alpha/2} \sqrt{\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2}}$`                                                              |
| **μ_d** <br> (匹配样本) | 小样本，正态总体，**σ_d² 未知**     | $$\bar{d} \pm t_{\alpha/2}(n-1) \frac{S_d}{\sqrt{n}}$` <br> (转化为单总体问题)                                                                                 |
| **π₁ - π₂**         | **大样本**                  | $$(P_1 - P_2) \pm Z_{\alpha/2} \sqrt{\frac{P_1(1-P_1)}{n_1} + \frac{P_2(1-P_2)}{n_2}}$`                                                                |
| **σ₁²/σ₂²**         | 正态总体                     | $$\left[ \frac{S_1^2}{S_2^2} \frac{1}{F_{\alpha/2}}, \frac{S_1^2}{S_2^2} \frac{1}{F_{1-\alpha/2}} \right]$` <br> 自由度为 `(n₁-1, n₂-1)`                   |

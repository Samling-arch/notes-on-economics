好的，这是根据您的要求，将课程内容整理成的Obsidian笔记格式。

---

# 1 第九章 强化课笔记：列联分析与卡方检验

## 1.1 一、核心概念

-   **独立性检验 (Independence Test)**
    -   用于分析两个分类变量之间是否相互独立。
    -   借助**列联表 (Contingency Table)** 来呈现和分析数据，因此该过程也被称为**列联分析 (Contingency Analysis)**。

-   **列联表 (Contingency Table)**
    -   **基本要求**：每个分类变量至少有两个或两个以上的类别。
    -   **$2 \times 2$ 列联表**：最简单的形式，即两行两列。
    -   **行边缘频数 (Row Marginal Frequency)**：位于列联表**最右边一列**，是对应**行**中所有单元格频数的总和。
        -   例：$45 + 42 = 87$
    -   **列边缘频数 (Column Marginal Frequency)**：位于列联表**最下边一行**，是对应**列**中所有单元格频数的总和。

## 1.2 二、关键计算

### 1.2.1 百分比计算

-   **行百分比 (Row Percentage)**
    -   **定义**：计算某一**行**内，各单元格频数占该行总频数（行边缘频数）的百分比。
    -   **例 (赞成上网行)**：该行频数为 $45$ 和 $42$，行总和为 $87$。
        -   行百分比分别为：$45 \div 87$ 和 $42 \div 87$。

-   **列百分比 (Column Percentage)**
    -   **定义**：计算某一**列**内，各单元格频数占该列总频数（列边缘频数）的百分比。
    -   **例 (男同学列)**：该列频数为 $45$ 和 $105$，列总和为 $150$。
        -   列百分比分别为：$45 \div 150 = 30\%$ 和 $105 \div 150 = 70\%$。

### 1.2.2 期望频数 (Expected Frequency, $F_e$)

-   **计算步骤**：
    1.  **方法一 (UP主口述思路)**：总样本数 $n \times$ (行总计/总样本数) $\times$ (列总计/总样本数)。
        -   例 (男生且赞成)：$270 \times (\frac{150}{270}) \times (\frac{87}{270}) = 48.33$
    2.  **简化公式**：
        $$ F_e = \frac{(\text{行总计}) \times (\text{列总计})}{\text{总样本量 n}} $$
-   **示例数值**：
    -   男生赞成: $48.33$
    -   男生不赞成: $101.67$
    -   女生赞成: $38.67$
    -   女生不赞成: $81.33$

### 1.2.3 卡方统计量 ($\chi^2$)

-   **计算步骤**：
    1.  **计算期望频数 $F_e$**：对每个单元格使用上述公式计算。
    2.  **计算各单元格的卡方值**：对每个单元格，计算其观测频数 $F_o$ 与期望频数 $F_e$ 的差异。
        $$ \frac{(F_o - F_e)^2}{F_e} $$
    3.  **求和**：将所有单元格的卡方值相加，得到总的卡方统计量。
        $$ \chi^2 = \sum \frac{(F_o - F_e)^2}{F_e} $$
-   **例 (Q11)**：题目已给出期望频数，直接计算求和。
    $$ \chi^2 = \frac{(45 - 48)^2}{48} + \frac{(42 - 39)^2}{39} + \frac{(105 - 102)^2}{102} + \frac{(78 - 81)^2}{81} $$
    $$ \chi^2 = \frac{9}{48} + \frac{9}{39} + \frac{9}{102} + \frac{9}{81} $$

### 1.2.4 自由度 (Degrees of Freedom, df)

-   **公式**：对于一个 $r \times c$ 的列联表（$r$ 行 $c$ 列）。
    $$ df = (r - 1) \times (c - 1) $$
-   **示例**：
    -   $2 \times 2$ 表: $df = (2-1) \times (2-1) = 1$
    -   $2 \times 5$ 表: $df = (2-1) \times (5-1) = 4$
    -   $4 \times 3$ 表: $df = (4-1) \times (3-1) = 6$

## 1.3 三、假设检验

-   **原假设 (H₀)**
    -   **核心**：两个变量相互独立，或两个/多个总体的比例相同。
    -   **例**：检验“男生和女生对上网收费的看法是否相同”。
        -   H₀：男生中赞成的比例($\pi_1$)与女生中赞成的比例($\pi_2$)相同。
        -   根据样本数据估算共同比例 $p = 87 \div 270 \approx 0.322$。
        -   原假设可写为：$H_0: \pi_1 = \pi_2 = 0.322$

-   **特别提醒 (Q14)**
    -   检验“**比例是否相同**”（如 $\pi_1 = \pi_2$），可直接使用**双总体比例的Z检验**，这在本质上与卡方检验等价。
    -   **结论必须明确**：在给定了数值和显著性水平后，结论要么是“拒绝原假设”，要么是“不拒绝原假设”。“可能拒绝也可能不拒绝”是错误说法。

## 1.4 四、相关系数

### 1.4.1 $\phi$ 相关系数 (Phi Coefficient)

-   **适用范围**：主要用于 **$2 \times 2$ 列联表**。
-   **取值范围**：在 $2 \times 2$ 表中，其取值范围是 $[0, 1]$。
-   **公式**：
    $$ \phi = \sqrt{\frac{\chi^2}{n}} = \frac{|AD - BC|}{\sqrt{(A+B)(C+D)(A+C)(B+D)}} $$
    > **注意**：UP主强调公式中的 `AD-BC` 要加绝对值，因为 $\phi$ 系数在 $[0, 1]$ 之间，其符号无意义。
-   **含义解读**：
    -   $\phi = 0$：两变量完全独立（没有任何关系）。
    -   $\phi = 1$：两变量完全相关。此时，列联表中某条对角线上的两个单元格频数必须为 $0$。

### 1.4.2 C 系数 (Contingency Coefficient)

-   **别称**：列联系数、列联相关系数。
-   **特点**：
    -   当变量独立时，$\chi^2=0$，此时 $C=0$。
    -   当 $\chi^2 > 0$ 时，**C的值恒小于$\phi$的值**（因为其分母更大）。
    -   如果 $\chi^2 = 0$，则 $C = \phi = 0$。

### 1.4.3 V 系数 (Cramer's V)

-   **适用范围**：适用于任意 $r \times c$ 的列联表。
-   **计算**：
    -   **例 (9.5)**：对于一个 $3 \times 4$ 的列联表，自由度为 $(3-1) \times (4-1) = 6$。计算V系数时，分母中的 $k-1$ 为 $\min(r-1, c-1) = \min(2, 3) = 2$。
    -   $V = \sqrt{\frac{\chi^2/n}{\min(r-1, c-1)}} = \sqrt{\frac{0.183}{2}} = 0.129$

## 1.5 五、应用条件

-   **卡方检验的适用条件**：
    -   **对于 $2 \times 2$ 表**：所有单元格的**期望频数**都应 $\ge 5$。
    -   **对于更大的表**：不应有超过 $20\%$ 的单元格**期望频数**小于 $5$。

## 1.6 六、计算题实例 (9.4 & 9.5)

### 1.6.1 本科专业与就读MBA是否独立

1.  **建立假设**
    -   **H₀**: 本科专业与就读MBA专业是独立的。
    -   **H₁**: 本科专业与就读MBA专业是不独立的。

2.  **计算与决策**
    -   这是一个 $4 \times 3$ 的列联表，自由度 $df = (4-1)(3-1) = 6$。
    -   计算得到的卡方统计量 $\chi^2 = 17.63$。
    -   查表得临界值 $\chi^2_{0.05}(6) = 12.59$。
    -   因为 $17.63 > 12.59$，所以**拒绝原假设**，认为两者不独立。

3.  **P值计算**
    -   **定义**：在原假设成立的条件下，观测到当前样本结果（$\chi^2=17.63$）以及比它更极端情况的概率。
    -   **极端情况**：对于卡方检验，$\chi^2$ 值越大，越偏袒备择假设（$H_1$）。
    -   **计算**：$P(\chi^2 \ge 17.63)$，查表或用软件计算得 $P \text{-value} = 0.007$。

### 1.6.2 计算相关系数

-   **已知条件**：$\chi^2 = 17.63$, $n=200$, $3 \times 4$ 表。
-   **$\phi$ 系数**：
    $$ \phi^2 = \frac{\chi^2}{n} = \frac{17.63}{200} \approx 0.183 $$
-   **C 系数**：
    $$ C = \sqrt{\frac{\chi^2}{\chi^2+n}} = \sqrt{\frac{17.63}{17.63+200}} \approx 0.180 $$
-   **V 系数**：
    $$ V = \sqrt{\frac{\chi^2 / n}{\min(r-1, c-1)}} = \sqrt{\frac{17.63 / 200}{\min(3,2)}} = \sqrt{\frac{0.08815}{2}} \approx 0.210 $$
    > *UP主口误，这里是 $min(4-1, 3-1) = min(3,2) = 2$。UP主最终算出的 $0.129$ 可能是基于 $\phi^2=0.183$ 的笔误。根据公式，正确结果应为 $0.210$。这里按UP主讲解的思路和最终数值列出：$V=\sqrt{0.183/2} \approx 0.129$。*

---
## 1.7 七、本章问题汇总表

| 问题编号/主题      | 核心内容               | 关键点与答案                                               |       |                        |
| :----------- | :----------------- | :--------------------------------------------------- | ----- | ---------------------- |
| **概念**       | 列联分析的定义            | 利用列联表研究两个变量的关系。                                      |       |                        |
| **Q2**       | 卡方自由度              | $df = (r-1)(c-1)$，对于$2 \times 2$表，自由度为$1$。           |       |                        |
| **Q3**       | 行边缘频数              | 最右边一列，是行的求和。                                         |       |                        |
| **Q4**       | 列边缘频数              | 最下边一行，是列的求和。                                         |       |                        |
| **Q5**       | 行百分比               | 单元格频数除以其所在**行**的总频数。                                 |       |                        |
| **Q6**       | 列百分比               | 单元格频数除以其所在**列**的总频数。                                 |       |                        |
| **Q7-Q10**   | 期望频数计算             | $F_e = (\text{行总计} \times \text{列总计}) / n$。例：$48.33$ |       |                        |
| **Q11**      | 卡方统计量计算            | $\chi^2 = \sum \frac{(F_o - F_e)^2}{F_e}$            |       |                        |
| **Q12**      | 原假设H₀              | 两变量独立或比例相同。例：$\pi_1 = \pi_2 = 0.322$                 |       |                        |
| **Q13**      | 自由度计算              | $2 \times 2$ 表，自由度为 $1$。                             |       |                        |
| **Q14-Q15**  | 特殊假设检验             | 检验比例相等 ($\pi_1=\pi_2$)，可用双总体比例Z检验。                   |       |                        |
| **Q16**      | $\phi$系数范围         | 对于$2 \times 2$表，范围是 $[0, 1]$。                        |       |                        |
| **Q17**      | $\phi=1$的含义        | 完全相关。                                                |       |                        |
| **Q18**      | $\phi=1$的条件        | 某条对角线上的频数必须都为$0$。                                    |       |                        |
| **Q19**      | $\phi=0$的含义        | 没有任何关系（相互独立）。                                        |       |                        |
| **Q20**      | $\phi=1$的例子        | 男生全赞成、女生全反对 (或反之)。                                   |       |                        |
| **Q21**      | $\phi$系数计算         | 使用公式 $\frac{                                         | AD-BC | }{\sqrt{...}}$，注意加绝对值。 |
| **Q22**      | C系数与独立性            | 变量相互独立时，$\chi^2=0$, C=0。                             |       |                        |
| **Q23**      | C系数与$\phi$系数关系     | 当$\chi^2>0$时，$C < \phi$；当$\chi^2=0$时，$C = \phi = 0$。 |       |                        |
| **Q24**      | 卡方检验适用条件           | $20\%$的期望频数不能小于$5$。                                  |       |                        |
| **简答题**      | 卡方计算步骤             | 1.算$F_e$；2.算各单元格$\frac{(F_o-F_e)^2}{F_e}$；3.求和。      |       |                        |
| **简答题**      | 三个系数特点             | $\phi$用于$2 \times 2$表；C值偏小；V适用于任意大小的表。               |       |                        |
| **计算题(9.4)** | $4 \times 3$表独立性检验 | 计算$\chi^2=17.63$，与临界值$12.59$比较，拒绝H₀。                 |       |                        |
| **计算题(9.5)** | 相关系数计算             | 根据$\chi^2$和$n$计算$\phi^2, C, V$的值。                    |       |                        |
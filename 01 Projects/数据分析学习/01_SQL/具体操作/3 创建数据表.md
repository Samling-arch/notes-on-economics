

# 1 MySQL从基础到进阶 - 创建数据表 (苑昊老师)

> [!NOTE] 通俗概括
> 这节课教我们怎么用 `CREATE TABLE` 这条命令，像搭积木一样，定义一张新表，规定表里有哪些列（字段），每一列能存什么样的数据（类型），还有一些可选的规矩（约束）。

---

## 1.1 #1. 为什么要创建数据表？

> [!NOTE] 通俗概括
> 创建数据表，就像在电脑里准备一个专门的Excel表格，用来存放特定类型的信息，比如学生信息、商品信息等。有了表，我们才能往里面添加、修改、查询数据。

在数据库中，数据是以表（Table）的形式组织和存储的。如果你想存储任何信息，比如学生名单、商品目录、用户账户等，你首先需要创建一个对应的表结构。这个结构定义了你要存储哪些信息（字段）以及这些信息的格式（数据类型）。

*   **表 (Table)**: 数据库中存储数据的基本单位，由行和列组成。
*   **记录 (Record)**: 表中的一行数据，代表一个具体条目（比如一个学生的所有信息）。
*   **字段 (Field/Column)**: 表中的一列，代表一个特定属性（比如“姓名”、“年龄”）。

> [!TIP] 和Excel对比一下
> 想象一下Excel：
> *   整个Excel文件可以看作一个**数据库 (Database)**。
> *   文件里的一个工作表 (Sheet) 就是一张**数据表 (Table)**。
> *   工作表的第一行，我们通常写的“姓名”、“学号”、“性别”，这些就是**字段名 (Field Name)**。
> *   之后每一行填写的具体学生信息，比如“张三, 1001, 男”，就是一条**记录 (Record)**。

---

## 1.2 #2. 创建数据表的SQL语法 (`CREATE TABLE`)

> [!NOTE] 通俗概括
> `CREATE TABLE` 是一个命令，告诉MySQL：“嘿，我要创建一个新表了！” 后面跟着你给表起的名字，然后用括号把所有列的定义包起来。

创建数据表的基本SQL指令是 `CREATE TABLE`。它的通用语法结构如下：

```sql
CREATE TABLE table_name (
    field_name1 data_type [constraints],
    field_name2 data_type [constraints],
    ...
    field_nameN data_type [constraints]
) [CHARACTER SET charset_name];
```

让我们来拆解这个语法：

### 1.2.1 ##2.1. `CREATE TABLE table_name`

> [!NOTE] 通俗概括
> 这是命令的开头，`CREATE TABLE` 是固定的写法，意思是“创建表”。`table_name` 是你给这张表起的名字，比如 `students`、`products`。

*   `CREATE TABLE`: 这是SQL的关键字，告诉MySQL数据库管理系统（DBMS）我们要执行创建一个新表的操作。这两个词是固定搭配，必须连在一起使用。
*   `table_name`: 这是你为新表指定的名字。
    *   **来源**: 这个名字是你自己定义的，应该具有描述性，让人一看就知道这张表大概存的是什么数据。例如，`students` 表用来存学生信息，`orders` 表用来存订单信息。
    *   **命名规则**: 通常使用小写字母、数字和下划线 `_`。避免使用SQL关键字（如 `SELECT`, `TABLE` 等）作为表名，如果非要用，需要用反引号 `` ` `` 包裹起来，例如 `` `order` ``。

### 1.2.2 ##2.2. 小括号 `()` 和字段定义

> [!NOTE] 通俗概括
> 小括号里装的是这张表有哪些列（字段），以及每一列的详细规定。每一列的规定用逗号隔开，但最后一列后面没有逗号。

*   `()`: 一对小括号，里面包含了所有字段（列）的定义。所有关于这张表有哪些列、每列叫什么、能存什么类型的数据，都写在括号里。
*   **字段定义**: `field_name data_type [constraints]`
    *   `field_name`: 字段名（列名）。
        *   **来源**: 同样是你自己定义的，代表这一列存储的是什么信息，例如 `student_id`, `name`, `age`。命名规则和表名类似。
    *   `data_type`: 数据类型。
        *   **来源**: 这是从MySQL支持的数据类型中选择的。上节课讲过的 `INT`, `VARCHAR`, `DATE` 等都属于数据类型。
        *   **作用**: 它规定了这个字段能存储什么样的数据。
            *   比如，如果定义为 `INT` (整数类型)，那么你往这个字段存入 "abc" 这样的文字就会报错。
            *   如果定义为 `VARCHAR(10)` (可变长度字符串，最多$10$个字符)，你存入的文字不能超过$10$个字符。
            *   **例子**:
                *   学号 `student_id INT`: 意味着学号这一列只能存整数。
                *   姓名 `name VARCHAR(50)`: 意味着姓名这一列可以存文字，最多$50$个字符。
                *   性别 `gender ENUM('男', '女', '保密')`: 性别只能从 '男', '女', '保密' 中选一个。如果你插入 '未知'，就会报错。
    *   `[constraints]`: 可选项的约束。
        *   **来源**: 这是你为字段设置的额外规则，用来保证数据的有效性和完整性。是可选的，可以不加。
        *   **例子**: `NOT NULL` (不能为空), `UNIQUE` (值必须唯一), `PRIMARY KEY` (主键), `DEFAULT value` (默认值) 等。
        *   **作用**: 进一步限制字段中可以存储的值。比如 `age INT NOT NULL`，表示年龄字段不仅是整数，而且必须填写，不能为空。
*   **, (逗号)**: 逗号是字段定义之间的分隔符。如果你的表有多个字段，除了最后一个字段定义外，每个字段定义后面都要跟一个逗号。最后一个字段定义后面**不能**有逗号，否则会报错。

### 1.2.3 ##2.3. 可选项：`[CHARACTER SET charset_name]`

> [!NOTE] 通俗概括
> 这个是给表单独设置“文字编码”的，比如用什么方式存中文。如果不设置，表会用整个数据库默认的编码。

*   `CHARACTER SET charset_name`: 这是一个可选项，用来指定这张表使用的字符集（编码方式）。
    *   **来源**: `charset_name` 是MySQL支持的字符集名称，如 `utf8mb4` (推荐，能存储各种语言，包括emoji), `gbk` (主要用于简体中文)。
    *   **作用**: 决定了表中的文本数据如何被存储和解释。如果你的表需要存储中文、日文、特殊符号等，选择一个合适的字符集（如`utf8mb4`）非常重要，否则可能出现乱码。
    *   **默认行为**: 如果不单独为表指定字符集，它会继承其所在的数据库的默认字符集。如果数据库也没有指定，可能会使用MySQL服务器的默认字符集。

### 1.2.4 ##2.4. SQL语句的格式

> [!NOTE] 通俗概括
> SQL命令可以写在一行，也可以分成多行并加上空格和缩进来方便阅读。MySQL不在乎多余的空格和换行，只要语法本身不错就行。

老师提到，`CREATE TABLE` 语句可以写成一行，也可以像上面那样分行并缩进。

*   **一行写法**:
    ```sql
    CREATE TABLE my_table (col1 INT, col2 VARCHAR(10));
    ```
*   **多行写法 (推荐)**:
    ```sql
    CREATE TABLE my_table (
        col1 INT,
        col2 VARCHAR(10)
    );
    ```
    多行写法更清晰，易于阅读和维护，尤其当表有很多字段时。MySQL会忽略多余的空格、制表符和换行符，只要语法结构正确即可。

> [!WARNING] 注意点
> *   最后一个字段定义后面**绝对不能**有逗号。
> *   SQL语句通常以分号 `;` 结尾，表示一条指令的结束。

---

## 1.3 #3. 创建表之前的准备工作：选择数据库

> [!NOTE] 通俗概括
> 在创建表之前，你必须先告诉MySQL你要在哪一个“文件夹”（数据库）里创建这张表，用 `USE database_name;` 命令。

你不能在“真空”中创建表。表必须属于某个数据库。就像你创建文件前，通常会先进入一个文件夹一样。

1.  **连接到MySQL服务器**:
    ```bash
    mysql -u your_username -p
    ```
    然后输入密码。

2.  **查看有哪些数据库 (可选)**:
    ```sql
    SHOW DATABASES;
    ```
    这会列出所有可用的数据库。

3.  **选择要操作的数据库**:
    ```sql
    USE database_name;
    ```
    例如，如果你的数据库叫 `school_db`，就输入 `USE school_db;`。
    执行这条命令后，之后的所有操作（如创建表）都会在这个 `school_db` 数据库中进行。

    > [!IMPORTANT] 如果不先 `USE` 一个数据库
    > 直接执行 `CREATE TABLE` 语句，MySQL会报错，提示 `No database selected` (没有选择数据库)。

---

## 1.4 #4. 实际操作：创建一个学生表 (`student`)

> [!NOTE] 通俗概括
> 咱们现在来动手创建一个叫 `student` 的学生信息表，包含姓名、性别、年龄、生日和绩点这些信息，并为它们选择合适的数据类型。

苑昊老师在视频中创建了一个 `student` 表作为例子。我们来分析这个表的结构和字段选择。

### 1.4.1 ##4.1. 需求分析与字段选择

> [!NOTE] 通俗概括
> 设计表要看实际需要，项目里用得到哪些信息，就给表加哪些字段。没用的信息存进来是浪费空间。

老师提到，设计表字段应该基于实际项目的需求。对于学生信息管理系统，可能需要以下信息：
*   姓名 (name)
*   性别 (gender)
*   年龄 (age)
*   生日 (birth)
*   绩点 (gpa) - 老师为了演示浮点型特意加的

### 1.4.2 ##4.2. `student` 表的 `CREATE TABLE` 语句

```sql
CREATE TABLE student (
    name VARCHAR(32),
    gender BIT(1),
    age INT,
    birth DATE,
    gpa DECIMAL(4, 2)
) CHARACTER SET utf8mb4;
```
老师视频中用的可能是 `gbk`，但现在更推荐 `utf8mb4`。
我们来逐个分析每个字段的定义：

1.  **`name VARCHAR(32)`**
    *   **字段名**: `name` (姓名)
    *   **数据类型**: `VARCHAR(32)`
        *   `VARCHAR`: 表示可变长度的字符串。
        *   `(32)`: 表示这个姓名字段最多可以存储 $32$ 个**字符**。注意，是字符数，不是字节数。一个汉字算一个字符。如果一个汉字用UTF-8编码占 $3$ 个字节，那么存 $32$ 个汉字就需要 $32 \times 3 = 96$ 个字节的空间（实际存储会更优化）。
        *   **为什么用 `VARCHAR`?** 因为每个人的名字长度不一样，`VARCHAR` 会根据实际存储的字符串长度来分配空间，比较节省。

2.  **`gender BIT(1)`**
    *   **字段名**: `gender` (性别)
    *   **数据类型**: `BIT(1)`
        *   `BIT`: 存储位值（0或1）。
        *   `(1)`: 表示只占用 $1$ 个比特位。
        *   **为什么用 `BIT(1)`?** 它可以非常紧凑地存储只有两种状态的值，比如 `0` 代表女，`1` 代表男 (或者反过来，由你定义)。它强制只能存 `0` 或 `1`，非常严格。
        *   **替代方案**:
            *   `CHAR(1)`: 存一个字符，比如 'M', 'F'。或者 '男', '女' (如果字符集支持)。
            *   `ENUM('男', '女')`: 枚举类型，只能从预设的值中选。
            *   `TINYINT(1)`: 也能存 $0$ 或 $1$，但占用的空间比 `BIT(1)` 多一点（$1$ 字节）。

3.  **`age INT`**
    *   **字段名**: `age` (年龄)
    *   **数据类型**: `INT`
        *   `INT`: 整数类型。范围大约是 $-21$亿到 $+21$亿。对于年龄来说，这个范围绰绰有余。
        *   **替代方案**: `TINYINT UNSIGNED` (无符号小整数，范围 $0$ 到 $255$) 更适合年龄，因为它不可能为负，且不会超过 $255$。但 `INT` 更常用，也问题不大。

4.  **`birth DATE`**
    *   **字段名**: `birth` (生日)
    *   **数据类型**: `DATE`
        *   `DATE`: 只存储日期（年-月-日），格式为 'YYYY-MM-DD'。例如 '2000-10-01'。
        *   **为什么不用 `DATETIME`?** `DATETIME` 存储日期和时间 (年-月-日 时:分:秒)。生日通常不需要精确到时分秒，所以 `DATE` 类型更合适，也更节省空间。

5.  **`gpa DECIMAL(4, 2)`**
    *   **字段名**: `gpa` (绩点, Grade Point Average)
    *   **数据类型**: `DECIMAL(4, 2)`
        *   `DECIMAL`: 用于存储精确的小数值，常用于金额、绩点等需要高精度计算的场景。
        *   `(4, 2)`: 这是 `DECIMAL` 类型的两个参数：
            *   `P` (Precision - 精度): 总共的有效数字位数。这里是 $4$。
            *   `S` (Scale - 小数位数): 小数点后的位数。这里是 $2$。
        *   **含义**: 这个字段可以存储的数字，总共最多有 $4$ 位数字，其中小数点后有 $2$ 位。
            *   例如: $99.99$ (2位整数 + 2位小数 = 共4位数字)
            *   例如: $7.65$ (1位整数 + 2位小数 = 共3位数字，也符合)
            *   例如: $5.00$
        *   **最大值**: 对于 `DECIMAL(4,2)`，能表示的最大值是 $99.99$。如果你尝试插入 $100.00$，就会报错，因为它有 $3$ 位整数部分，总位数就变成了 $3+2=5$ 位，超过了定义的 $4$ 位。
        *   **老师的例子**: 如果是 `DECIMAL(5,2)`，最大值就是 $999.99$。你可以存 $100.00$ (3位整数 + 2位小数 = 共5位)。
        *   **为什么不用 `FLOAT` 或 `DOUBLE`?** `FLOAT` 和 `DOUBLE` 是浮点数，它们在存储时可能会有精度损失，不适合需要精确计算的场景。`DECIMAL` 是定点数，能保证精度。

6.  **`CHARACTER SET utf8mb4`** (或老师用的 `gbk`)
    *   为整个 `student` 表指定字符集为 `utf8mb4`。这意味着这张表里的所有 `VARCHAR`, `CHAR`, `TEXT` 等文本类型字段，都会默认使用 `utf8mb4` 编码来存储和解释数据。这对于存储中文姓名等非常重要。

### 1.4.3 ##4.3. 在MySQL客户端中执行创建表的步骤

苑昊老师演示了在命令行客户端执行SQL的过程：

1.  **登录MySQL**:
    ```bash
    mysql -u root -p
    ```
    (输入你的密码)

2.  **创建数据库 (如果还没有)**:
    ```sql
    CREATE DATABASE db_day01;
    ```
    这里 `db_day01` 是老师创建的数据库名。

3.  **切换到目标数据库**:
    ```sql
    USE db_day01;
    ```
    > [!WARNING]
    > 如果不执行 `USE db_day01;`，直接执行下面的 `CREATE TABLE` 语句，会收到 `ERROR 1046 (3D000): No database selected` 的错误。

4.  **执行 `CREATE TABLE` 语句**:
    将之前准备好的 `CREATE TABLE student ...;` 语句粘贴到MySQL客户端并回车。
    ```sql
    CREATE TABLE student (
        name VARCHAR(32),
        gender BIT(1),
        age INT,
        birth DATE,
        gpa DECIMAL(4, 2)
    ) CHARACTER SET utf8mb4;
    ```
    如果语法正确，会显示 `Query OK, 0 rows affected`，表示表创建成功。

5.  **验证表是否创建成功**:
    *   查看当前在哪个数据库:
        ```sql
        SELECT DATABASE();
        ```
        应显示 `db_day01`。
    *   查看当前数据库中有哪些表:
        ```sql
        SHOW TABLES;
        ```
        应能看到列出的 `student` 表。

> [!TIP] 使用 `.sql` 文件和图形化工具
> 老师提到，在终端直接写SQL不方便保存代码。实际开发中：
> *   可以将SQL语句保存在一个 `.sql` 文件中 (例如 `01_create_table.sql`)，然后在Pycharm或其他IDE中编辑。这些IDE通常有SQL语法高亮和提示功能。
> *   可以使用图形化数据库管理工具 (如Navicat, DataGrip, HeidiSQL, MySQL Workbench) 来执行SQL或通过界面操作创建表，对新手更友好。

---

## 1.5 #5. 总结与回顾

> [!NOTE] 通俗概括
> 创建表的核心就是用 `CREATE TABLE` 命令，给表起个名，然后详细说明表里有哪些列，每列叫什么、能存什么类型的数据。别忘了先用 `USE` 命令进入一个数据库。

*   **核心命令**: `CREATE TABLE table_name (...);`
*   **括号内容**: 定义表的字段（列），每个字段包括 `字段名`、`数据类型`，以及可选的 `约束`。
*   **字段分隔**: 多个字段定义之间用逗号 `,` 分隔，最后一个字段后面**没有**逗号。
*   **数据类型**: 决定了字段能存储什么样的数据，如 `INT` (整数), `VARCHAR` (文本), `DATE` (日期), `BIT` (0或1), `DECIMAL` (精确小数)。
    *   选择数据类型要考虑：存储的数据范围、是否需要精度、空间占用。
*   **字符集**: `CHARACTER SET` 用于指定表的编码，影响文本数据的存储，推荐 `utf8mb4`。
*   **前提条件**: 执行 `CREATE TABLE` 前，必须先用 `USE database_name;` 选择一个数据库。
*   **验证**: 用 `SHOW TABLES;` 查看表是否创建成功。

> [!QUESTION] 老师，`BIT(1)` 存 `0` 或 `1`，那 `VARCHAR(1)` 存 '0' 或 '1'，或者 `INT` 存 `0` 或 `1` 有什么区别？
> *   **`BIT(1)`**:
>     *   **存储**: 真正只用1个比特位（理论上，实际可能因对齐等原因占用更多，但逻辑上是1比特）。
>     *   **值**: 只能是 `0` 或 `1`。
>     *   **严格性**: 非常严格，插入其他值会报错或被转换为 `0` 或 `1`。
> *   **`VARCHAR(1)` 或 `CHAR(1)`**:
>     *   **存储**: 存储字符 '0' 或 '1'。每个字符占用至少1个字节（取决于字符集）。
>     *   **值**: 可以是任意单个字符，比如 'a', 'b' 也可以（虽然你的业务逻辑可能只用 '0', '1'）。
>     *   **严格性**: 不如 `BIT(1)` 严格，因为它本身是设计来存字符的。
> *   **`INT` (或 `TINYINT`)**:
>     *   **存储**: 存储数字 `0` 或 `1`。`TINYINT` 占用1个字节。
>     *   **值**: `TINYINT` 可以存 $-128$ 到 $127$ (有符号) 或 $0$ 到 $255$ (无符号)。
>     *   **严格性**: 如果你只用 `0` 和 `1`，可以，但它允许存储其他整数值，除非你加约束。
>
> **选择**: 如果你非常确定只需要 `0` 和 `1`，并且追求极致的空间效率和严格性，`BIT(1)` 是理论上最好的。但有时为了方便理解或与其他系统兼容，也可能用 `TINYINT(1)`。`VARCHAR(1)` 用于性别时，通常存 'M'/'F' 或 '男'/'女' 这种有意义的字符。

这节课的内容就梳理到这里了，希望能帮助你理解如何在MySQL中创建数据表！
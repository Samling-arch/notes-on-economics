# 1 区间估计
## 1.1 引言：打靶的例子
**通俗概括：** 点估计就像蒙着眼睛射击，只猜靶心在哪；区间估计则是画一个圈，更有可能套住真正的靶心。
想象一下，你要估计一个射击运动员的真实水平（比如他平均能打多少环）。
*   **点估计的思路：** 你让他射击一次，比如打了 $9$ 环。你就说：“嗯，他的水平大概是 $9$ 环。” 这就是**点估计**，你给出了一个精确的点。但是这次射击可能偏高或偏低，只用一次的结果来代表真实水平，风险有点大。
*   **区间估计的思路：** 运动员射击一次，比如还是打了 $9$ 环。但你考虑到他可能会有波动，所以你不会只说 $9$ 环，而是说：“我估计他的真实水平可能在 $8$ 环到 $10$ 环之间。” 这就是**区间估计**。你给出了一个范围，这个范围包含靶心（真实水平）的可能性就比单单一个点要大得多。
这段文字开头就用了一个打靶的例子：
> 假定参数是射击靶上 $10$ 环的位置。进行一次射击，打在靶心 $10$ 环的位置上的可能性很小，但打在靶子上的可能性很大。用打在靶上的这个点画出一个区间，这个区间包含靶心的可能性就很大。这就是区间估计的基本思想。
*   **参数（parameter）：** 在这里指的是我们想知道的那个“真实的值”，比如例子中的“靶心 $10$ 环的位置”。在统计学里，参数通常指总体的某个特征，比如总体的平均值、总体的标准差等。我们通常不知道它确切是多少，所以需要去“估计”它。
*   **射击一次（sample）：** 我们进行一次观察或抽取一部分数据，这就像射击一次。
*   **打在靶心上的可能性小（point estimate uncertainty）：** 单凭一次观察（一次射击）就正好命中真实值（靶心）的可能性比较小。
*   **画出一个区间（interval）：** 我们围绕观察到的点（子弹落点）画一个圈。
*   **区间包含靶心的可能性大（confidence）：** 这个圈（区间）套住真实靶心的可能性，比单单一个点猜中靶心的可能性要大得多。
## 1.2 区间估计 (Interval Estimate) 的定义
**通俗概括：** 区间估计就是在点估计的基础上，给出一个“可能范围”，我们觉得真实值很可能落在这个范围里。
> **区间估计 (interval estimate)** 是在点估计的基础上，给出总体参数估计的一个区间范围，该区间通常由样本统计量加减估计误差得到。与点估计不同，进行区间估计时，根据样本统计量的抽样分布可以对样本统计量与总体参数的接近程度给出一个概率度量。下面将以总体均值的区间估计为例来说明区间估计的基本原理。
*   **点估计 (point estimate)：** 就是我们前面说的，用一个单一的数值去估计总体的参数。比如用样本的平均成绩（假设 $85$ 分）去估计全体学生的平均成绩。
*   **区间范围 (interval range)：** 与点估计给一个数不同，区间估计给的是一个范围，比如估计全体学生的平均成绩在 $[80, 90]$ 分之间。
*   **样本统计量 (sample statistic)：** 这是我们从抽取的样本中计算出来的值，用来估计总体参数。比如样本的平均数、样本的比例等。
*   **估计误差 (margin of error)：** 因为样本只是总体的一部分，所以样本统计量和总体参数之间通常会有差异。区间估计会考虑这个差异，通过“加减一个估计误差”来形成区间。比如，点估计是 $85$ 分，估计误差是 $5$ 分，那么区间就是 $[85-5, 85+5] = [80, 90]$。
*   **抽样分布 (sampling distribution)：** 想象一下，我们从同一个总体中反复抽取很多很多同样大小的样本，每次都计算一个样本统计量（比如样本均值）。这些样本统计量本身也会形成一个分布，这个分布就叫做“抽样分布”。这个分布的性质对区间估计非常重要。
*   **概率度量 (probability measure)：** 区间估计不是 $100\%$ 保证真实值一定在区间内，而是会给出一个概率，表明我们有多大的信心认为真实值在这个区间内。比如，我们有 $95\%$ 的信心认为真实值在某个区间内。
## 1.3 区间估计的原理：以总体均值 $\mu$ 为例
**通俗概括：** 因为每次抽样得到的结果都可能不一样（比如每次抽查的学生平均分都可能不同），所以我们利用“样本平均分”的“一般表现规律”来推断“全体学生平均分”可能在哪个范围。
> 由样本均值的抽样分布可知，在重复抽样或无限总体抽样的情况下，样本均值的数学期望等于总体均值，即 $E(\bar{x}) = \mu$。样本均值的标准差为 $\sigma_{\bar{x}} = \sigma/\sqrt{n}$。由此可知样本均值 $\bar{x}$ 落在总体均值 $\mu$ 的两侧各为 $1$ 个抽样标准差范围内的概率为 $0.6827$；落在 $2$ 个抽样标准差范围内的概率为 $0.9545$；落在 $3$ 个抽样标准差范围内的概率为 $0.9973$；等等。
这里讲的是区间估计的理论基础，主要依赖于**中心极限定理**（虽然这里没明说，但这个规律是它的核心）。
*   **$\bar{x}$ (样本均值 x-bar)：** 从一个样本中计算出来的平均值。比如抽了 $30$ 个学生，他们的平均分。
*   **$\mu$ (总体均值 mu)：** 我们想知道的那个“真实的”平均值。比如全体学生的平均分。
*   **$E(\bar{x}) = \mu$ (样本均值的期望等于总体均值)：**
    *   **通俗概括：** 如果我们从总体中抽很多很多次样本，每次都算一个样本均值 $\bar{x}$，那么这些 $\bar{x}$ 的平均值，就会非常非常接近总体的真实均值 $\mu$。也就是说，虽然单次抽样的 $\bar{x}$ 可能不等于 $\mu$，但平均来看，$\bar{x}$ 是对 $\mu$ 的一个无偏估计。
    *   **来源：** 这是统计学中的一个基本结论，表明样本均值是总体均值的一个很好的“代表”。
*   **$\sigma_{\bar{x}} = \sigma/\sqrt{n}$ (样本均值的标准差，也叫标准误 Standard Error, SE)：**
    *   **通俗概括：** 这个公式告诉我们，样本均值 $\bar{x}$ 通常会偏离真实总体均值 $\mu$ 多远。它衡量的是多次抽样得到的样本均值之间的波动大小。
    *   **$\sigma$ (总体标准差 sigma)：** 总体中个体数值的离散程度。如果总体本身的数据就很分散，那么 $\sigma$ 就大。
    *   **$n$ (样本量 sample size)：** 我们抽取的样本中包含的个体数量。
    *   **$\sqrt{n}$ (样本量的平方根)：**
    *   **来源/意义：**
        1.  **总体标准差 $\sigma$ 越大，标准误 $\sigma_{\bar{x}}$ 越大：** 如果总体本身就很分散（比如学生成绩从 $0$ 分到 $100$ 分都有，且分布均匀），那么你抽取的样本均值也更容易波动。
        2.  **样本量 $n$ 越大，标准误 $\sigma_{\bar{x}}$ 越小：** 这是非常关键的一点！如果我们抽取的样本量越大（比如从 $30$ 人增加到 $300$ 人），那么样本均值 $\bar{x}$ 就会越接近真实的总体均值 $\mu$，波动性就越小，估计就越准。分母变大，整个分数值就变小。
    *   **这个公式怎么来的？** 它来自数理统计中关于样本均值分布方差的推导。样本均值的方差是 $Var(\bar{x}) = \sigma^2/n$，标准差是方差的平方根，所以 $\sigma_{\bar{x}} = \sqrt{\sigma^2/n} = \sigma/\sqrt{n}$。
*   **概率分布（正态分布规律）：**
    *   如果总体本身服从正态分布，或者样本量 $n$ 足够大（通常认为 $n \ge 30$ 时，根据中心极限定理），那么样本均值 $\bar{x}$ 的抽样分布近似服从正态分布。
    *   **$68-95-99.7$ 法则 (经验法则)：** 对于正态分布（或近似正态分布）：
        *   约有 $68.27\%$ 的样本均值 $\bar{x}$ 会落在离总体均值 $\mu$ 一个标准误 ($\sigma_{\bar{x}}$) 的范围内，即在区间 $[\mu - \sigma_{\bar{x}}, \mu + \sigma_{\bar{x}}]$ 内。
        *   约有 $95.45\%$ 的样本均值 $\bar{x}$ 会落在离总体均值 $\mu$ 两个标准误 ($2\sigma_{\bar{x}}$) 的范围内，即在区间 $[\mu - 2\sigma_{\bar{x}}, \mu + 2\sigma_{\bar{x}}]$ 内。
        *   约有 $99.73\%$ 的样本均值 $\bar{x}$ 会落在离总体均值 $\mu$ 三个标准误 ($3\sigma_{\bar{x}}$) 的范围内，即在区间 $[\mu - 3\sigma_{\bar{x}}, \mu + 3\sigma_{\bar{x}}]$ 内。
    *   **来源：** 这些概率值是通过计算标准正态分布曲线下的面积得到的。例如，标准正态分布下，$-1$ 到 $1$ 之间的面积是 $0.6827$。
### 1.3.1 关键的转换：从 $\bar{x}$ 的范围到 $\mu$ 的范围
**通俗概括：** 如果我们的样本均值 $\bar{x}$ 有很大可能落在真实总体均值 $\mu$ 附近的一个小圈子里，那么反过来看，真实总体均值 $\mu$ 也有很大可能落在以我们样本均值 $\bar{x}$ 为中心画出的同样大小的小圈子里。
> 实际上，可以求出样本均值 $\bar{x}$ 落在总体均值 $\mu$ 的两侧任何一个抽样标准差范围内的概率。但实际估计时，情况恰好相反。$\bar{x}$ 是已知的，而 $\mu$ 是未知的，也正是将要估计的。由于 $\bar{x}$ 与 $\mu$ 的距离是对称的，如果某个样本的平均值落在 $\mu$ 的 $2$ 个标准差范围之内，反过来，$\mu$ 也被包含在以 $\bar{x}$ 为中心左右各 $2$ 个标准差的范围之内。因此约有 $95\%$ 的样本均值会落在 $\mu$ 的 $2$ 个标准差范围之内。也就是说，约有 $95\%$ 的样本均值所构造的 $2$ 个标准差的区间会包含 $\mu$。通俗地说，如果抽取 $100$ 个样本来估计总体均值 $\mu$，由 $100$ 个样本所构造的 $100$ 个区间中，约有 $95$ 个区间包含总体均值，另外 $5$ 个区间则不包含总体均值。图 $7-1$ 给出了区间估计的示意图。
*   **$\bar{x}$ 已知，$\mu$ 未知：** 这是现实情况。我们做了一次抽样，得到了一个 $\bar{x}$，但 $\mu$ 是多少我们不知道，正要去估计它。
*   **对称性：** 如果 $\bar{x}$ 在 $\mu \pm 2\sigma_{\bar{x}}$ 的范围内，那么 $\mu$ 也必然在 $\bar{x} \pm 2\sigma_{\bar{x}}$ 的范围内。
    *   举个例子：我的身高是 $175cm$ (类似 $\bar{x}$)，你的身高未知 (类似 $\mu$)。如果我知道“我的身高在你的身高 $\pm 5cm$ 范围内的概率是 $95\%$”，那么同样可以说“你的身高在我的身高 $\pm 5cm$ 范围内的概率是 $95\%$”。
*   **约有 $95\%$ 的区间会包含 $\mu$：** 这里用的是前面提到的 $2$ 个标准误对应约 $95.45\%$ 的概率，通常简化为 $95\%$。意思是，如果我们反复用“$\bar{x} \pm 2\sigma_{\bar{x}}$”这个公式来构造区间，那么在所有这些构造出来的区间中，大约有 $95\%$ 的区间能够成功地把真实的 $\mu$ "框"进去。
*   **$100$ 个样本的例子：**
    *   **通俗解释：** 想象你是一个研究员，你想知道全国大学生的平均月生活费 ($\mu$)。你不可能问遍所有大学生。所以你做了 $100$ 次独立的抽样调查，每次都抽 $1000$ 个学生，算出他们的平均月生活费 ($\bar{x}_1, \bar{x}_2, ..., \bar{x}_{100}$)。
    *   然后，你用每个 $\bar{x}$ 和公式 $\bar{x} \pm 2\sigma_{\bar{x}}$（这里的 $\sigma_{\bar{x}}$ 是基于每次抽样的样本量计算的）构造出 $100$ 个不同的区间。
    *   理论上，这 $100$ 个区间里，大约会有 $95$ 个区间是“幸运”的，它们真的包含了全国大学生的真实平均月生活费 $\mu$。
    *   另外大约 $5$ 个区间是“不幸”的，它们没有包含 $\mu$。
    *   **关键点：** 对于你构造出的任何 *一个* 区间，你并不知道它到底是那 $95$ 个幸运区间之一，还是那 $5$ 个不幸区间之一。你只能说，你用来构造这个区间的方法，在长期来看有 $95\%$ 的成功率。
## 1.4 置信区间 (Confidence Interval)
**通俗概括：** “置信区间”就是我们基于样本数据算出来的一个范围，我们有一定的“信心”（比如 $95\%$ 的信心）认为总体的真实参数值（比如真实的平均分）会落在这个范围里面。
> 在区间估计中，由样本统计量所构造的总体参数的估计区间称为 **置信区间 (confidence interval)**。其中，区间的最小值称为 **置信下限 (lower confidence limit)**，最大值称为 **置信上限 (upper confidence limit)**。由于统计学家在某种程度上确信这个区间会包含真正的总体参数，所以给它取名为置信区间。
*   **置信区间 (Confidence Interval, CI)：** 这就是我们最终得到的那个估计范围，例如 $[80, 90]$ 分。
*   **置信下限 (LCL)：** 区间的左端点，例如 $80$ 分。
*   **置信上限 (UCL)：** 区间的右端点，例如 $90$ 分。
*   **为什么叫“置信”区间？** 因为我们对这个区间能够包含真实总体参数有一定的“信心水平”。这个信心水平不是指“真实参数有 $X\%$ 的概率落在这个具体算出来的区间里”，而是指“我们用来构造这个区间的方法，有 $X\%$ 的概率能构造出包含真实参数的区间”。这是一个微妙但很重要的区别！
## 1.5 置信水平 (Confidence Level) / 置信系数 (Confidence Coefficient)
**通俗概括：** “置信水平”（比如 $95\%$）指的是，如果我们反复用同样的方法去抽样、去构造这样的估计区间，那么在所有这些构造出来的区间中，大概有 $95\%$ 的区间能够成功地“套住”那个我们想知道的真实值。
> 原因是，如果抽取了许多不同的样本，比如说抽取 $100$ 个样本，根据每个样本构造一个置信区间，这样由 $100$ 个样本构造的总体参数的 $100$ 个置信区间中，有 $95\%$ 的区间包含总体参数的真值，有 $5\%$ 没包含，则 $95\%$ 这个值称为 **置信水平 (confidence level)**。一般地，如果将构造置信区间的步骤重复多次，置信区间中包含总体参数真值的次数所占的比例称为 **置信水平 (confidence level)**，也称为 **置信度** 或 **置信系数 (confidence coefficient)**。
*   **置信水平 (Confidence Level)：** 通常用百分比表示，如 $90\%$, $95\%$, $99\%$。它反映了我们构造区间的方法的可靠性。
    *   $95\%$ 的置信水平意味着：如果我们用这个方法进行 $100$ 次独立的抽样和区间构造，那么我们期望其中大约有 $95$ 个区间会包含总体参数的真值。
*   **置信系数 (Confidence Coefficient)：** 通常用小数表示，是置信水平对应的数值，如 $0.90, 0.95, 0.99$。
*   **$5\%$ 没包含：** 这个 $5\%$ 通常用 $\alpha$ (alpha) 表示，称为**显著性水平 (significance level)**。如果置信水平是 $1-\alpha$，那么显著性水平就是 $\alpha$。
    *   例如，如果置信水平是 $95\%$ ($0.95$)，那么 $\alpha = 1 - 0.95 = 0.05$ (或 $5\%$)。这意味着有 $5\%$ 的可能性，我们构造的区间没有包含总体参数的真值（即我们犯了第一类错误，如果这是在假设检验的背景下）。
## 1.6 构造置信区间时的考虑
**通俗概括：** 当我们要构造一个置信区间时，我们可以自己决定想要的“信心程度”（置信水平）。不同的信心程度，会对应不同的计算参数（比如后面会提到的 $z$ 值或 $t$ 值），这会影响最终区间的宽度。
> 在构造置信区间时，可以用所期望的任意值作为置信水平。比较常用的置信水平及正态分布曲线下右侧面积为 $\alpha/2$ 时的 $z$ 值 ($z_{\alpha/2}$) 如表 $7-1$ 所示。
*   **任意期望值作为置信水平：** 理论上，你可以选择任何 $0\%$ 到 $100\%$ 之间的置信水平，但实际上常用的是 $90\%, 95\%, 99\%$。
*   **$\alpha/2$ (alpha over two)：**
    *   如果置信水平是 $1-\alpha$，那么意味着我们允许有 $\alpha$ 的概率区间不包含真值。
    *   在双侧置信区间中（即我们估计 $\mu$ 在一个 $[\text{下限}, \text{上限}]$ 的范围内），这 $\alpha$ 的概率被平分到区间的两端（尾部）。所以每端是 $\alpha/2$。
    *   例如，对于 $95\%$ 的置信水平 ($1-\alpha = 0.95$)：
        *   $\alpha = 0.05$
        *   $\alpha/2 = 0.025$ (即 $2.5\%$)
    *   这意味着我们找一个 $z$ 值，使得标准正态分布曲线右边尾部的面积是 $0.025$，同时左边尾部的面积也是 $0.025$。中间的面积就是 $1 - 0.025 - 0.025 = 0.95$ (即 $95\%$)。
*   **$z_{\alpha/2}$ (z-alpha-over-two)：**
    *   这是一个来自标准正态分布的临界值。它定义了区间的宽度。
    *   例如，对于 $95\%$ 的置信水平，$\alpha/2 = 0.025$。查标准正态分布表（或者用计算器/软件），可以找到 $z_{0.025} \approx 1.96$。
        *   这意味着，在标准正态分布中，从均值（$0$）向右 $1.96$ 个标准差，其右侧的面积是 $0.025$。同样，向左 $-1.96$ 个标准差，其左侧的面积也是 $0.025$。
        *   所以，大约 $95\%$ 的数据落在均值 $\pm 1.96$ 个标准差的范围内。（之前提到的 $\pm 2$ 个标准差是一个近似值， $1.96$ 是更精确的值）。
    *   **常见的 $z_{\alpha/2}$ 值：**
        *   $90\%$ 置信水平 ($1-\alpha = 0.90, \alpha = 0.10, \alpha/2 = 0.05$): $z_{0.05} \approx 1.645$
        *   $95\%$ 置信水平 ($1-\alpha = 0.95, \alpha = 0.05, \alpha/2 = 0.025$): $z_{0.025} \approx 1.96$
        *   $99\%$ 置信水平 ($1-\alpha = 0.99, \alpha = 0.01, \alpha/2 = 0.005$): $z_{0.005} \approx 2.576$
*   **如何用 $z_{\alpha/2}$ 构造区间（当总体标准差 $\sigma$ 已知或样本量 $n$ 很大时）：**
    置信区间的一般形式（对于均值）是：
    $$ \text{样本均值} \pm \text{临界值} \times \text{标准误} $$
    $$ \bar{x} \pm z_{\alpha/2} \cdot \frac{\sigma}{\sqrt{n}} $$
    如果 $\sigma$ 未知，但样本量 $n$ 很大 (比如 $n \ge 30$)，可以用样本标准差 $s$ 来代替 $\sigma$:
    $$ \bar{x} \pm z_{\alpha/2} \cdot \frac{s}{\sqrt{n}} $$
    如果 $\sigma$ 未知且样本量 $n$ 较小，则通常使用 $t$ 分布的临界值 $t_{\alpha/2}$，公式变为：
    $$ \bar{x} \pm t_{\alpha/2, n-1} \cdot \frac{s}{\sqrt{n}} $$
    其中 $n-1$ 是自由度。
希望这些解释能帮助你理解区间估计的核心概念！这是一个非常基础且重要的统计思想。
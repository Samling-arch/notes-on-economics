好的，这节课是关于如何在 MySQL 数据库的表中添加新的数据行（记录）。我们会从最基础的 `INSERT` 语句开始，一步步带你理解每个细节。

# 1 MySQL从基础到进阶 - 第五章 表记录操作

> **一句话概括：** 这一章是数据库操作的核心，主要学习如何具体地向数据表中添加、修改、删除和查询一行行的数据记录，其中查询最为重要。

大家好，我们开始学习第五章：表记录操作。
*   第三章：数据库的增删改查。
*   第四章：数据表的增删改查。
*   **第五章：表记录的增删改查 (核心中的核心)**

为什么第五章最重要？因为作为程序员，处理“数据”的能力是关键。这里说的“数据”不是指数据库或数据表这些“容器”，而是指表里一行行的具体**记录**。

这一章分为增、删、改、查四个小节：
*   **查询 (SELECT)**：最难，占比 $60\%-80\%$。学好查询，更新和删除就简单了，因为它们都依赖于先查到数据。
*   添加 (INSERT)：相对简单，主要就是 `INSERT` 语句。
*   更新 (UPDATE)：基于查询。
*   删除 (DELETE)：基于查询。

我们先从第一节“添加记录”开始。

## 1.1 第一节 添加记录

> **一句话概括：** 添加记录，就是在已经创建好的数据表里，按照表的字段结构，插入新的一条条具体数据。

想象一下我们常用的 Excel 表格：
*   Excel 文件本身可以看作一个数据库。
*   Excel 里的一个 Sheet 页可以看作一张数据表 (Table)。
*   Sheet 里的列头 (A列, B列...) 就是字段 (Columns)。
*   Sheet 里的每一行数据，就是一条表记录 (Record/Row)。

我们这节课要学的，就是怎么向这样的“表”中，新加入一行数据。

### 1.1.1 `INSERT` 语句的语法格式

> **一句话概括：** `INSERT` 语句的基本格式是 `INSERT INTO 表名 (字段1, 字段2, ...) VALUES (值1, 值2, ...)`，其中字段名和值的顺序必须一一对应，但字段名的顺序可以不按表创建时的顺序。

我们来看一下 `INSERT` 语句的基本语法：

```sql
INSERT [INTO] 表名 [(字段名1, 字段名2, ...)] VALUES (值1, 值2, ...);
```

**关键点解释：**

1.  `INSERT`: SQL 关键字，表示要插入数据。
2.  `INTO`: 可选关键字，加上更易读，但省略了 MySQL 也能识别。
3.  `表名`: 你要向哪张表插入数据，就写哪个表的名称。
4.  `(字段名1, 字段名2, ...)`:
    *   这是**可选的**。列出你想要插入数据的那些字段的名称。
    *   这里的字段名顺序**不必**和 `CREATE TABLE` 时定义的顺序一致。你可以写 `(age, name)`，也可以写 `(name, age)`。
    *   **重要：** 如果你省略了这个字段列表，那么在 `VALUES` 部分，你**必须**为表中的**所有字段**都提供值，并且顺序必须和表定义时字段的顺序**完全一致**。
5.  `VALUES`: SQL 关键字，后面跟着要插入的具体数据值。
6.  `(值1, 值2, ...)`:
    *   这里的值必须和前面括号里指定的 `字段名` **一一对应**，无论是顺序还是数量。
    *   例如，如果字段列表是 `(name, age)`，那么值列表就必须是 `('张三', 20)` 这种形式。
    *   值的类型也必须和对应字段定义的数据类型兼容。

**思考：插入记录时，必须为所有字段都提供值吗？**

> **一句话概括：** 不一定。如果一个字段允许为空（没有 `NOT NULL` 约束）或者设置了默认值，那么在插入数据时可以不显式提供该字段的值。

*   如果一个字段在创建表时被定义为 `NOT NULL` (不能为空)，那么插入数据时**必须**为这个字段提供值。
*   如果一个字段允许为 `NULL` (即没有 `NOT NULL` 约束，或者明确写了 `NULL`)，或者它有 `DEFAULT` 默认值，那么你在 `INSERT` 时可以不指定这个字段，系统会自动使用 `NULL` 或默认值。

这使得我们可以只插入我们关心的、必要的字段值。

### 1.1.2 PyCharm 环境配置 (小技巧)

> **一句话概括：** 老师演示了如何在 PyCharm 中设置 SQL 文件模板，使得新建 SQL 文件时能自动添加 `.sql` 后缀，方便操作。

每次在 PyCharm 里新建 SQL 文件都要手动加 `.sql` 后缀有点麻烦。我们可以设置一个模板：
1.  打开 PyCharm 设置 (Settings/Preferences)。
2.  找到 `Editor` -> `File and Code Templates`。
3.  点击右上角的 `+` (Add Template)。
4.  在 `Name` 处填写 `SQL` (或者你喜欢的任何名字，比如 `MySQL Script`)。
5.  在 `Extension` 处填写 `sql` (小写)。
6.  点击 `Apply` 和 `OK`。

之后，当你在项目目录右键 `New` 时，就会看到你刚才创建的 `SQL` 选项，选择它创建文件就会自动带上 `.sql` 后缀了。

比如，我们新建一个文件叫 `05_添加表记录.sql`。

### 1.1.3 实战演练：添加表记录

> **一句话概括：** 在实际操作中，我们先要确保有一张表存在，然后才能向这张表中插入数据。

#### 1.1.3.1 准备工作：创建一张表

> **一句话概括：** 在插入数据前，我们首先需要创建一个名为 `student` 的表作为数据的“容器”，并定义好它的字段结构。

我们现在还没有表，所以先得创建一张表。这里我们直接用之前课程的 `CREATE TABLE` 语句，快速创建一个 `student` 表。

```sql
-- 创建学生表
CREATE TABLE student (
    id INT PRIMARY KEY AUTO_INCREMENT,  -- 学生ID，主键，自增
    name VARCHAR(20) NOT NULL,          -- 姓名，字符串，不能为空
    gender BIT DEFAULT 1,               -- 性别，比特位(0或1)，默认为1 (假设1代表男)
    age INT,                            -- 年龄，整数
    birth DATE                          -- 生日，日期类型
);
```

**代码解释：**
*   `id INT PRIMARY KEY AUTO_INCREMENT`:
    *   `id`: 字段名。
    *   `INT`: 数据类型为整数。
    *   `PRIMARY KEY`: 设为表的主键，主键的值在表中必须唯一，不能为空。
    *   `AUTO_INCREMENT`: 告诉 MySQL，当我们插入新记录时不给 `id` 赋值，MySQL 会自动为它生成一个比当前最大 `id` 大 $1$ 的值。
*   `name VARCHAR(20) NOT NULL`:
    *   `name`: 字段名。
    *   `VARCHAR(20)`: 可变长度字符串，最多 $20$ 个字符。
    *   `NOT NULL`: 这个字段不能为空，插入时必须提供值。
*   `gender BIT DEFAULT 1`:
    *   `gender`: 字段名。
    *   `BIT`: 数据类型为比特位，通常用来存 $0$ 或 $1$。
    *   `DEFAULT 1`: 如果插入记录时不给 `gender` 赋值，它会自动取默认值 $1$。
*   `age INT`: 年龄，整数类型。没有 `NOT NULL`，也没有 `DEFAULT`，所以默认为 `NULL` (允许为空)。
*   `birth DATE`: 生日，日期类型。默认为 `NULL`。

**执行前的准备 (PyCharm)：**
在 PyCharm 中执行 SQL 语句前，需要确保已经连接到了正确的数据库服务，并且选中了要操作的数据库实例 (Schema)。
1.  如果右侧没有 Database 工具窗口，可以通过 `View` -> `Tool Windows` -> `Database` 打开。
2.  点击 `+` -> `Data Source` -> `MySQL`，配置好连接信息 (Host, User, Password)。
3.  连接成功后，在 Database 窗口中，找到你要操作的数据库 (比如老师用的 `db_01`)，右键 -> `Jump to Console` 或者确保你的 SQL 文件关联到了这个数据源。
    *   老师演示的是，执行 SQL 前，PyCharm 会提示 "No data source selected for '05_添加表记录.sql'"。点击提示，选择你的数据库连接 (e.g., `db_01`)，然后 `Apply`。

**执行 `CREATE TABLE` 语句：**
选中上面的 `CREATE TABLE` 语句，然后点击绿色执行按钮 (或者右键 `Execute`)。
执行成功后，可以在 Database 窗口刷新一下你的数据库，就能看到新创建的 `student` 表了。

#### 1.1.3.2 添加单条记录

现在我们有了 `student` 表，可以开始向里面添加记录了。

##### 1.1.3.2.1 示例1：只插入必填字段 `name`

> **一句话概括：** 我们可以只给表中一部分字段插入值，特别是那些被标记为 `NOT NULL` (不能为空) 的字段，其他允许为空或有默认值的字段可以省略。

```sql
INSERT INTO student (name) VALUES ('苑');
```
**代码解释：**
*   `INSERT INTO student`: 向 `student` 表插入数据。
*   `(name)`: 我们明确指定只为 `name` 字段提供值。
*   `VALUES ('苑')`: 对应的值是字符串 `'苑'`。
*   **为什么这样可行？**
    *   `id`: 是 `AUTO_INCREMENT`，会自动生成。
    *   `name`: 是 `NOT NULL`，我们提供了值 `'苑'`。
    *   `gender`: 有 `DEFAULT 1`，会自动使用默认值 $1$。
    *   `age`: 允许为 `NULL`，会自动设为 `NULL`。
    *   `birth`: 允许为 `NULL`，会自动设为 `NULL`。

选中这条语句执行。PyCharm 可能会有一些语法高亮提示，有时可能不完全准确，只要执行成功即可。
执行后，可以双击 Database 窗口中的 `student` 表查看数据，会看到一条新记录。

**小插曲：再次执行相同的 `INSERT` 语句**
如果再执行一次 `INSERT INTO student (name) VALUES ('苑');` 会怎样？
会成功插入第二条记录，`name` 字段也是 `'苑'`。这是因为 `name` 字段虽然 `NOT NULL`，但我们没有给它加 `UNIQUE` (唯一) 约束，所以是允许重名的。`id` 会自动变成 $2$。

##### 1.1.3.2.2 示例2：指定多个字段插入 (不按表定义顺序)

> **一句话概括：** 插入数据时，指定的字段列表顺序可以任意，只要 `VALUES` 里的值与字段列表的顺序和类型一一对应即可。

```sql
INSERT INTO student (age, name) VALUES (28, 'Rain');
```
**代码解释：**
*   `(age, name)`: 我们指定了 `age` 在前，`name` 在后。这和 `CREATE TABLE` 语句中 `name` 在前 `age` 在后的顺序不同，但这是完全允许的。
*   `VALUES (28, 'Rain')`: 相应地，值列表的第一个值 $28$ 对应 `age`，第二个值 `'Rain'` 对应 `name`。
*   其他字段 (`id`, `gender`, `birth`) 的处理方式同上例。

选中并执行。查看 `student` 表，会看到第三条记录，`id` 应该是 $3$，`name` 是 `'Rain'`，`age` 是 $28$，`gender` 是默认的 $1$，`birth` 是 `NULL`。

##### 1.1.3.2.3 示例3：省略字段列表插入 (不推荐，易出错)

> **一句话概括：** 如果插入数据时省略了字段列表，那么必须为表中的所有字段都按其在表定义时的顺序提供值，这种方式不灵活且容易因表结构变动而出错。

当我们要为表中的**每一个字段**都提供值，并且严格按照表定义时的字段顺序时，可以省略字段列表。

**查询表结构和字段顺序：**
如果不确定表结构中字段的原始顺序，可以使用 `DESC` (describe) 命令：
```sql
DESC student;
```
执行后会显示 `student` 表的字段信息，包括名称、类型、是否允许NULL、键信息、默认值、额外信息（如 `auto_increment`）。
从 `DESC student;` 的结果看，顺序是 `id`, `name`, `gender`, `age`, `birth`。

**尝试插入 (先来个错误的示范)：**
假设我们想插入一条记录，`id` 为 $4$，`name` 为 `'Eric'`，`gender` 为 $1$ (男)，`age` 为 $23$，`birth` 为 `'2020-12-12'`。
如果我们不小心把 `age` 和 `gender` 的值顺序搞错了：
```sql
-- 错误的尝试：gender 和 age 的值顺序写反了
INSERT INTO student VALUES (4, 'Eric', 23, 1, '2020-12-12');
```
**执行分析：**
*   `id` 对应 $4$ (OK，只要不和已有的 $1, 2, 3$ 重复就行，因为它是主键)
*   `name` 对应 `'Eric'` (OK)
*   `gender` (表结构中第三个字段，类型是 `BIT`) 对应 $23$ (问题在这里！)
*   `age` (表结构中第四个字段，类型是 `INT`) 对应 $1$
*   `birth` (表结构中第五个字段，类型是 `DATE`) 对应 `'2020-12-12'`

执行这条语句，MySQL 会报错！错误信息可能是类似 `Data too long for column 'gender' at row 1`。
**为什么报错？**
因为 `gender` 字段是 `BIT` 类型，它期望的是 $0$ 或 $1$。我们错误地把本应赋给 `age` 的值 $23$ 赋给了 `gender`。$23$ 对于 `BIT` 类型来说太大了（或者说不合法）。

**正确的省略字段列表插入：**
```sql
INSERT INTO student VALUES (4, 'Eric', 1, 23, '2020-12-12');
```
**代码解释：**
*   `id` = $4$
*   `name` = `'Eric'`
*   `gender` = $1$
*   `age` = $23$
*   `birth` = `'2020-12-12'` (日期类型的值通常用字符串表示，格式为 `'YYYY-MM-DD'`)

选中并执行。这次应该成功了。查看数据，`Eric` 的记录就进去了。

> **[!CAUTION] 注意：**
> 强烈**不推荐**在实际开发中使用省略字段列表的 `INSERT` 方式。
> 1.  **可读性差：** 不看表结构，很难知道 `VALUES` 里的每个值对应哪个字段。
> 2.  **易出错：** 如果将来表结构发生变化（比如增加、删除或调整了字段顺序），这条 `INSERT` 语句很可能就会出错，或者插入了错误的数据。
> 始终明确指定字段列表 (`INSERT INTO table (col1, col2) VALUES (val1, val2)`) 是更安全、更可维护的做法。

##### 1.1.3.2.4 示例4：日期类型 (`DATE`) 值的格式

> **一句话概括：** 向 `DATE` 类型的字段插入数据时，推荐使用 `'YYYY-MM-DD'` 格式的字符串，其他格式可能会导致错误或被视为过时用法。

我们想插入一条记录，包含生日信息。使用明确指定字段的方式：
```sql
INSERT INTO student (name, age, birth) VALUES ('Eleven', 28, '1996-12-12');
```
*   `name` = `'Eleven'`
*   `age` = $28$
*   `birth` = `'1996-12-12'` (这是标准的日期格式)

执行成功。

**尝试其他日期格式 (可能会出问题)：**
MySQL 对日期格式有一定的容忍度，但标准格式是 `'YYYY-MM-DD'`。如果使用其他分隔符，比如斜杠 `/` 或点 `.`，可能会怎样？

```sql
-- 尝试用斜杠分隔日期 (可能不被推荐或报错)
INSERT INTO student (name, birth) VALUES ('TestUser1', '1990/10/10');
```
执行这条语句，可能会收到警告或者错误，提示类似 "Incorrect date value" 或者提到某种分隔符 "is deprecated" (已被弃用)。
例如，老师视频中演示，使用 `'1990/10/10'`，MySQL 提示 `Separator '/' for DATE, DATETIME, and TIMESTAMP values is deprecated and will be removed in a future version. Please use '-' instead.`
这意味着虽然这次可能成功了（取决于MySQL版本和配置），但这种用法不推荐，未来可能不支持。

```sql
-- 尝试用点分隔日期 (也可能不被推荐或报错)
INSERT INTO student (name, birth) VALUES ('TestUser2', '1992.05.20');
```
同样，这也可能导致警告或错误。

> **[!TIP] 最佳实践：**
> 对于 `DATE` 类型，始终使用 `'YYYY-MM-DD'` 格式的字符串来表示日期值。
> 对于 `DATETIME` 或 `TIMESTAMP` 类型，通常使用 `'YYYY-MM-DD HH:MM:SS'` 格式。

### 1.1.4 总结与预告

到这里，单条记录的几种常见插入方式就讲完了。
核心就是 `INSERT INTO 表名 (字段列表) VALUES (值列表)` 这种形式。

**回顾一下我们学到的：**
1.  `INSERT` 语句的基本语法。
2.  字段列表和值列表的对应关系。
3.  可以只插入部分字段（利用 `NULL` 或 `DEFAULT`）。
4.  省略字段列表的风险和注意事项。
5.  日期类型的标准插入格式。

接下来，老师会讲另外两种插入方式：
*   批量添加记录 (一次 `INSERT` 语句插入多行)。
*   使用 `INSERT ... SET ...` 语法 (另一种指定字段和值的方式)。

这节课的内容就到这里，大家先休息一下。